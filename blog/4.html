<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>
			Initial Commit
		</title>
		<meta charset='utf-8'>
		<link rel="stylesheet" type="text/css" href="../css/index.css">
		<link rel="icon" href="../icon.png">
	</head>
	<body>
		<div id="headerdiv">
			<a href="index.html">Back</a>
		</div>
		<div id="maindiv">
			<h1>Custom Keyboard Layouts</h1>
				<p>2022-06-20</p>
			<hr />
			<p>If you're using a PC or laptop keyboard, there's a good chance it comes with the EN (US) keyboard layout. That's the letters of the English alphabet, along with special symbols like <code>;:'"[]()</code>. This is a great layout for general use as well as programming.</p>
			<p>What this layout lacks is the special letters non-English languages use. Hungarian uses <code>óöőúüűí</code>, German <code>öüäß</code>, and Romanian <code>îăâșț</code>, along with their capitalized versions.</p>
			<p>To type these letters, the typical solution is to change the keyboard layout to the language's. However, this doesn't come without the drawback of messing with the existing layout of symbols. For example on the Hungarian 101-key layout, the key to the right of <code>p</code> results in <code>ő</code>. That's great... but how do I type <code>[</code> now? Am I forced to forever be switching between the different layouts, having to not only learn each of them, but get used to my layout changing all the time?</p>
			<p>Luckily there is a solution. The right Alt key, also called AltGr. It can be used in combination with existing keys to produce new symbols. For example, I can have the following setup:</p>
			<table>
				<tr>
					<th>Keys pressed</th>
					<th>Result</th>
				</tr>
				<tr>
					<td>[</td>
					<td>[</td>
				</tr>
				<tr>
					<td>Shift [</td>
					<td>{</td>
				</tr>
				<tr>
					<td>AltGr [</td>
					<td>ő</td>
				</tr>
				<tr>
					<td>Shift AltGr [</td>
					<td>Ő</td>
				</tr>
			</table>
			<p>Similarly, I could (and did) create keybinds for all the letters I want to type in the three languages I need. In short, I had to create a custom keyboard layout.</p>
			<p>I personally use a Linux laptop, but I was provided a Windows laptop for work. Follow along with my adventure as I get things working on each platform.</p>
			<h2>Windows 11</h2>
			<p>Windows is not exactly known for its support of user choice, and Windows 11 is perhaps worse than 10. Despite this, the <u>Microsoft Keyboard Layout Creator</u> is totally functional.</p>
			<img src="img/ckl_dloadcreator.png">
			<p>Naturally, we get a banner about third-party cookies on the download page. I will give Microsoft credit for the clearly visible Reject button though - the internet has gotten scummy enough that not all sites have even that.</p>
			<p>This might not be the best time to mention that I actually had to edit the HTML of the page to take this screenshot. Originally, about 70% of the page was taken up by an ad for a laptop.</p>
			<p>You might ask "Do I really need to install a program to generate a keyboard layout - essentially a configuration file?". To you I say: ask less questions. Just accept the License Agreement without reading it and proceed.</p>
			<img src="img/ckl_installcreator.png">
			<p>Not so fast! The <i>installer</i> for the <abbr title="Microsoft Keyboard Layout Creator">MSKLC</abbr> told me that I had to install the .NET Framework. Specifically version 3.5 - you know, from the year 2008.</p>
			<p>One more download later, I installed the .Net Framework. I could move on to installing MSKLC. That installer only crashed once (refusing to close even when "killed" from the Task Manager)". Luckily, after a few minutes, it decided to work.</p>
			<p>The MSKLC actually looks alright. I had to load the English keyboard to make modifications on top of that layout. Totally reasonable. Then, I just had to click the corresponding key and I could input what character I wanted that key to type.</p>
			<img src="img/ckl_kcl.png">
			<p>Now you might intuitively think that Shift-clicking a key would change what Shift + that key types. <i>lol</i>.</p>
			<p>I spent a few minutes copy-pasting the characters from Wikipedia into this tool. Again, that's perfectly fine - if I could type them, I wouldn't be here in the first place.</p>
			<p>Once finished, I could Validate the layout. This came with a nice little animation on my taskbar.</p>
			<img src="img/ckl_spaz.gif">
			<p>I ended up successfully exporting my custom layout into... this.</p>
			<img src="img/ckl_files.png">
			<p>As strange as it is to have a keyboard layout as a <code>.exe</code> file, it actually worked.</p>
			<p>It took a while to navigate through Windows' menu system. The mix of the legacy Control Panel and the limited but new Settings App is truly a wonder to work with. In the end, I narrowed it down to this page. Changing the keyboard layout was somewhere in here.</p>
			<img src="img/ckl_menu.png">
			<p>Did you find it? It's this little dropdown.</p>
			<img src="img/ckl_menu2.png">
			<br><small>Yes, that arrow was added in MS Paint. Antialiasing is not a thing.</small>
			<p>I realized that I made a mistake! I accidentally put <code>î</code> on <code>AltGr z</code> and <code>â</code> on <code>AltGr q</code>. I wanted them the other way around.</p>
			<p>No problem! I remembered to save the layout file before exporting, so I just open it up, switch the two around, and export it again, right?</p>
			<p><i>Right?</i></p>
			<p>Well, I got the following error message. Well, technically I got an error message pointing to a log file, but that's just details at this point.</p>
			<code>ERROR: The keyboard name 'N_KB' is already in use on this machine.</code>
			<p>Yes.</p>
			<p>Yes, it's in use.</p>
			<p>And I want to override it.</p>
			<p>Well, searching for the error message, I got <a target="_blank" href="https://answers.microsoft.com/en-us/windows/forum/all/how-do-i-remove-a-keyboard-layout/8836ef84-8742-425c-b9d2-ba56acf3e5fc">this</a> question regarding the same problem on Microsoft's website, where an actual Microsoft employee responded with the wonderfully unhelpful "idk, ask somewhere else".</p>
			<img src="img/ckl_divya.png">
			<br><small>Notice how it's marked with a green checkmark as the Answer.</small>
			<p>The <i>totally</i> sustainable workaround was to simply give my layout a new name. Enter <code>Copy-of-N_KB_final_5_final</code>.</p>
			<p>It took a while, but in the end I got the keyboard working. Was there a better way to do things? Who knows. Even if there was, Windows did a terrible job at communicating it.</p>
			<h2>Arch Linux</h2>
			<p>You're going to have to edit this file: <u>/usr/share/X11/xkb/symbols/us</u>.</p>
			<p>For example, if your editor is Mousepad, you would run <code>sudo mousepad /usr/share/X11/xkb/symbols/us</code>.</p>
			<p>You will find one line for each keyboard key, each with two symbols defining what the key alone and the key with Shift pressed down does. You need to append two more for AltGr + Key and Shift + AltGr + Key.</p>

			<img src="img/ckl_pre.png">
			<br><b>↓</b><br>
			<img src="img/ckl_post.png">
			<p>If it's a Unicode character, you're going to have to use its <a href="https://unicode-table.com/en/", target="_blank">Unicode Number</a>.</p>
			<p>When you're done, save the file, and log out of your graphical environment (or just reboot).</p>
		</div>
	</body>
</html>
